# Sealed Secrets para datos sensibles con rotación automática
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: database-sealed-secrets
  namespace: ecommerce-dev
  annotations:
    sealedsecrets.bitnami.com/managed: "true"
    sealedsecrets.bitnami.com/rotation-time: "30d"
spec:
  encryptedData:
    # Estos valores deben ser generados con kubeseal
    # Comando: echo -n "password123" | kubeseal --raw --name=database-sealed-secrets --namespace=ecommerce-dev
    mysql-password: AgBy3i4OJSWK+PiTySYZZA9rO7HUQ...  # Placeholder - generar con kubeseal
    mysql-root-password: AgAKdwWGogdo5mEBMIaCARmF0t+...  # Placeholder - generar con kubeseal
  template:
    metadata:
      name: database-sealed-secrets
      namespace: ecommerce-dev
      labels:
        app: ecommerce
        component: database
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: jwt-sealed-secrets
  namespace: ecommerce-dev
  annotations:
    sealedsecrets.bitnami.com/managed: "true"
    sealedsecrets.bitnami.com/rotation-time: "7d"  # JWT keys rotan más frecuentemente
spec:
  encryptedData:
    # Estos valores deben ser generados con kubeseal
    jwt-secret: AgAKdwWGogdo5mEBMIaCARmF0t+...  # Placeholder - generar con kubeseal
    jwt-signing-key: AgBy3i4OJSWK+PiTySYZZA9rO7H...  # Placeholder - generar con kubeseal
  template:
    metadata:
      name: jwt-sealed-secrets
      namespace: ecommerce-dev
      labels:
        app: ecommerce
        component: auth
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: api-keys-sealed-secrets
  namespace: ecommerce-dev
  annotations:
    sealedsecrets.bitnami.com/managed: "true"
    sealedsecrets.bitnami.com/rotation-time: "90d"
spec:
  encryptedData:
    # APIs externas
    payment-gateway-api-key: AgBy3i4OJSWK+PiTySYZZ...  # Placeholder
    shipping-api-key: AgAKdwWGogdo5mEBMIaCARmF0t...  # Placeholder
    email-service-api-key: AgBy3i4OJSWK+PiTySYZZA...  # Placeholder
  template:
    metadata:
      name: api-keys-sealed-secrets
      namespace: ecommerce-dev
      labels:
        app: ecommerce
        component: external-apis
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: monitoring-sealed-secrets
  namespace: ecommerce-dev
  annotations:
    sealedsecrets.bitnami.com/managed: "true"
    sealedsecrets.bitnami.com/rotation-time: "60d"
spec:
  encryptedData:
    prometheus-password: AgBy3i4OJSWK+PiTySYZZA9rO...  # Placeholder
    grafana-admin-password: AgAKdwWGogdo5mEBMIaCARm...  # Placeholder
    elasticsearch-password: AgBy3i4OJSWK+PiTySYZZA9...  # Placeholder
  template:
    metadata:
      name: monitoring-sealed-secrets
      namespace: ecommerce-dev
      labels:
        app: ecommerce
        component: monitoring
    type: Opaque
---
apiVersion: bitnami.com/v1alpha1
kind: SealedSecret
metadata:
  name: registry-sealed-secrets
  namespace: ecommerce-dev
  annotations:
    sealedsecrets.bitnami.com/managed: "true"
    sealedsecrets.bitnami.com/rotation-time: "180d"
spec:
  encryptedData:
    .dockerconfigjson: AgBy3i4OJSWK+PiTySYZZA9rO7HUQ...  # Placeholder para Docker registry
  template:
    metadata:
      name: registry-sealed-secrets
      namespace: ecommerce-dev
      labels:
        app: ecommerce
        component: registry
    type: kubernetes.io/dockerconfigjson